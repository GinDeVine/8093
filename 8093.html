<html>
<head>
<title>8093:</title>
<script src="8093.js"></script>
<script>

window.onload = function(){
	var img = document.getElementById("targetImage");
	window.dragenter = function(ev) {
  		ev.stopPropagation();
		ev.preventDefault();
	}
	window.dragover = function(ev) {
		ev.stopPropagation();
		ev.preventDefault();
	}
	img.drop = function(ev) {
		ev.stopPropagation();
		ev.preventDefault();
		var files = ev.dataTransfer.files;
		if(files.length>1)return alert("Just one file, thankyouverymuch!")
		else if(files[0].type != "image/png") return alert("Use .png files, thankyouverymuch!")
		else return useImage(files[0]);
	}
	img.addEventListener("dragenter", dragenter, false);
	img.addEventListener("dragover", dragover, false);
	img.addEventListener("drop", img.drop, false);
}

function useImage(file){
	var img = document.getElementById("targetImage");
	img.name = "thisisnohiddenmessage"
	var reader = new FileReader();
	reader.onload = function(ev) {
		img.src = ev.target.result;
	}
	reader.onerror = function(ev){
		return Error("FileError. Dropped file could not be read.");
	}
	reader.readAsDataURL(file);
}


</script>
<style>
*{margin:0;padding:0;border-radius:4px;}
body{background-color:#fcfcfc;font-size:14px;font-family:helvetica,"Helvetica Neue",arial,sans-serif;line-height:1.5;background-image:url("footer.png");background-repeat:no-repeat;background-position:bottom;padding-bottom:180px;}

div#content {width:600px;margin:0 auto;}
div#upper	{padding:20px 0 0 0;text-align:center;}
div#middle	{padding:5px 0 10px 0;}
div#bottom	{}

h1#title	{font-size:50px;}
h3#under	{font-size:30px;margin-top:-20px;}
h3#notice	{font-size:20px;position:relative;right:20px;}
h3#about	{font-size:25px;position:relative;right:20px;}

p#about	{}
p#intro	{font-weight:bold;}
p		{padding:5px 0 5px 0;}

.code	{font-family:monospace;white-space:pre-wrap;}
.button	{cursor:pointer;text-decoration:none;color:#000;}
.button:hover {text-decoration:underline;}
.mail{direction: rtl; unicode-bidi: bidi-override;}
.skinny{font-weight:100;color:#666;font-size:80%;}
hr		{margin:20px 0;}

textarea{width:450px;height:100px;padding:5px;border-color:#ccc;}
input[type=text]	{width:40px;padding:3px; margin-right:5px;border: 1px solid #ccc;}
input[type=text]#x	{}
input[type=text]#y	{}
input[type=text]#z	{width:280px;}

img#targetImage{width:100px;height:100px;margin: 0 20px;float:right;border: solid 1px #ccc;background-color:#FFF;}
img#targetImage:hover{border: solid 3px #c0c0fe;background-color:#f6f6Ff;position:relative;top:-2px;right:-2px;}

</style>
</head>
<body>
	<div id="content">
		<div id="upper">
			<h1 id="title">8093</h1>
			<h3 id="under">Hidden within pixels</h3>
		</div>
		<hr/>
		<div id="middle">
		<h3 id="">Okay, let's go hiding some data! <a href="#about" class="button skinny"><sup>[?]</sup></a></h3>
		<textarea id="data" placeholder="What is five times nine?"></textarea>
		<img src="drag.png" id="targetImage" title="Drag the desired image here!"></img>
		<br/>
		<input type="text" placeholder="x" id="x"/><input type="text" placeholder="y" id="y" /><input type="text" placeholder="z" id="z" />
		<b class="button" onclick="hide()">Hide</b>/<b class="button" onclick="seek()">Seek</b>
		<h3 id="errorConsole"></h3>
		</div>
		<hr/>
		<div id="bottom">
			<h3 id="about" name="about">ABOUT</h3>
			<p id="about">
				<p id="intro">
					Hiding data within the opacity of images, starting at pixel (x,y) with an interval of z(i) between every pixel. Unused pixel get a slight static noise of opacity. The opacity is barely - if at all - noticable by the bare eye, and even though you know it's there, you'll need both x and y and especially z to find it.
				</p>
				<p>
					This will only work with newer web-browsers, so it's reccomended you have Google Chrome, or any other that has the same canvas and file API support as Chrome. Drag and drop the desired image (in PNG format) onto the square beside the text-field. If you want to hide your data in it, paste or write the data in the text-field and hit "Hide". If you want to extract the data from the image, simply press "Seek" and - with some luck - the data will appear in the text-field.
				</p>
				<p>
					Both when hiding and seeking, you might want to set the x, y and z. The coordinate (x,y) is the starting position in the image where the data is stored, and z is a function which returns the interval between each pixel where data should be stored. An example of z could be <b class="code">function(i){return i*2}</b> which uses every other pixel. One can do quite a lot more with z, as long as z(i) returns an integer and never the same integer with i from 0 to twice the length of the data. An error will be displayed if there's not enough room in the image to store the data with the given xyz. If no x, y or z is given, their default values will be used. (a bit more advanced z could be <b class="code">function(i){return Math.floor(i*i+Math.sin(i)*i)}</b>)
				</p>
				<p>
					Due to security reasons, it's not without problems to get images from external servers, and at the moment one is therefore limited to local images dropped onto the page. There's only two other methods of passing this security measure, one is pasting the PNG data URL at this site, and the other is to fetch the image through server side code. As the former would be bothersome for the user and the latter being hard on the server as well as time-consuming, I have yet to implement either option. Therefore, for now, one has to download the desired image.
				</p>
				<p>
					Thank you for taking the time to look at my little app. Questions, suggestions, critique or comments in general is well appreciated, though you'd have to go through mail, as this page lacks a comment section.
				</p>
			</p>
			<h3 id="notice">GDV:2011</h3>
			<h5 class="mail">moc[ tod ]liamg[ ta ]enivednig</h5>
		</div>
	</div>
</body>
</html>